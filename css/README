CS samplingパッケージ 2012/2/3 
山口 雅博 作 (yamaguchi@mi.cs.titech.ac.jp)

CS samplingの実験キットです.

############################
#    ファイルとフォルダ     #
############################

/src           : ソースファイル群
/bin           : バイナリファイル(makefile により作られたファイルを格納)
/train         : モデルとデータ(dice,uw-1)
/result        : 実験結果を格納
README         : このファイル
makefile       : makeと打つとcssamp,csslearn,marginalを作る
sample.sh      : サンプリング実験用のシェル、詳しくは".bin/cssamp -h"して下さい.
marginal.sh    : 周辺確率計算用のシェル、詳しくは"./bin/marginal -h"して下さい.
learn.sh       : 勾配法に基づくパラメータ学習用のシェル、詳しくは"./bin/csslearn -h"して下さい.

############################
#         実験手順          #
############################

この実験キット上では3つの実験ができます.

　1: p(x|F) 又は Uniform(F)からのサンプリング(CS sampling or SampleSAT).
　2: 周辺確率の近似計算
　3: 勾配法に基づくパラメータ学習

////////////////////////////////////////
1,サンプリングは以下のコマンドで行います.
$ make cssamp
$ ./sample.sh -b dice
デフォルトはCS samplingですので、"-m"オプションでSampleSATからサンプリングできます.
$ make cssamp
$ ./sample.sh -b dice -m
コンマ区切りのサンプル及び、パラメータは"./result/samp/"以下に格納されます.
CS samplingならば".sli"ファイル、SampleSATならば".sam"ファイルができます.
~.prb : ベルヌーイ分布(条件付きでない分布)のパラメータを記述
~.txt : 実験の設定及び、速度などを記述

////////////////////////////////////////
2,周辺確率の近似計算は以下のコマンドで行います.
$ make marginal
$ ./marginal.sh -b dice -r 5 -s 10000
周辺確率計算は5回まで実験を行い，その平均をことができます．"-r"は平均を取る回数を指定します.
上では5回の平均を計算します."-s"はサンプリングに用いるサンプル数を指定します.
実験結果は"./result/marginal/"に格納されます.以下のファイルができます.
~.eps : x軸をサンプル、y軸をヘリンガー距離とした図
~.txt : 5回分の実験の設定及び、速度などを記述

////////////////////////////////////////
3,パラメータ学習は以下のコマンドで行います.
$ make csslearn
$ ./learn.sh -b dice -u 1000 -s 100 -i 0.01
"-u"はパラメータの更新回数を決め、"-s"は一回の更新に用いるサンプル数、"-i"は学習係数を決めます.
デフォルトはCSsampling+MA法による期待値の近似計算を行い、"-m"オプションによりSampleSAT+ISに変更できます.
実験結果は"./result/learn/"に格納されます.
~.eps : x軸を更新ステップ数、y軸をヘリンガー距離とした図
~.txt : 実験の設定及び、速度などを記述

############################
#         モデル           #
############################

・dice    : 小規模な人工モデル
・smoking : 中規模なベンチマークモデル
・uw1~5   : 中～大規模なモデル(論理式はワシントン大学の実際の人間関係を表現する)

サンプリングには".cnf"ファイルが必要です.周辺確率計算には".cnf"ファイ
ルと".prb"ファイルが必要です.パラメータ学習には".cnf"ファイルと".prb"
ファイルと".sli"ファイルが必要です.ファイルのボディは"-b"で指定できま
す.新しくモデルを作成する場合は"./train/"内に必要なファイルを置いて下
さい.

############################
#          備考            #
############################

上の動作例は全て小規模なdiceモデルを使っています.diceモデルにおけるパ
フォーマンスはSampleSAT+ISが良いです.CSsampling+MAは中規模～大規模モデ
ルの場合に効果を発揮します."-b dice"の部分を"-b uw1"とすると、少し時間
がかかりますがCSsampling+MAの方が良い結果を得ることができます.uw1につ
いて周辺確率計算とパラメータ学習を行った実行結果は予め"./result/"内に置
いてあります.



